<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <base href="/nhslogin">
     <link rel="stylesheet"  href="nhslogin/css/main.css">
      <link rel="stylesheet"  href="nhslogin/css/mobile-menu.css">
    <script src="nhslogin/js/main.min.js" ></script> 
<link rel="shortcut icon" href="/nhslogin/images/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/nhslogin/images/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="/nhslogin/images/apple-touch-icon-180x180.png">
<link rel="mask-icon" href="/nhslogin/images/favicon.svg" color="#005eb8">
<link rel="icon" sizes="192x192" href="/nhslogin/images/favicon-192x192.png">

<title>Single Sign On</title>
  </head>
  <body>
      <header class="nhsuk-header" role="banner">
        <div class="nhsuk-width-container nhsuk-header__container">
          <div class="nhsuk-header__logo">
            <a class="nhsuk-header__link nhsuk-header__link--service " href="/nhslogin" aria-label="NHS digital service manual homepage">
              <svg class="nhsuk-logo" xmlns="http://www.w3.org/2000/svg" role="presentation" focusable="false" viewBox="0 0 40 16">
                <path class="nhsuk-logo__background" d="M0 0h40v16H0z"></path>
                <path class="nhsuk-logo__text" d="M3.9 1.5h4.4l2.6 9h.1l1.8-9h3.3l-2.8 13H9l-2.7-9h-.1l-1.8 9H1.1M17.3 1.5h3.6l-1 4.9h4L25 1.5h3.5l-2.7 13h-3.5l1.1-5.6h-4.1l-1.2 5.6h-3.4M37.7 4.4c-.7-.3-1.6-.6-2.9-.6-1.4 0-2.5.2-2.5 1.3 0 1.8 5.1 1.2 5.1 5.1 0 3.6-3.3 4.5-6.4 4.5-1.3 0-2.9-.3-4-.7l.8-2.7c.7.4 2.1.7 3.2.7s2.8-.2 2.8-1.5c0-2.1-5.1-1.3-5.1-5 0-3.4 2.9-4.4 5.8-4.4 1.6 0 3.1.2 4 .6"></path>
                <image src="https://assets.nhs.uk/images/nhs-logo.png" xlink:href=""></image>
              </svg>
              <span class="nhsuk-header__service-name">
              NHS login - developer documentation
            </span>
            </a>
          </div>
          <div class="nhsuk-header__menu">
            <button class="nhsuk-header__menu-toggle" id="toggle-menu" aria-controls="header-navigation" aria-label="Open menu">Menu</button>
          </div>

          <div class="nhsuk-header__content" id="content-header"></form>
        </div>
      </div>
    </div>
  </div>
  <nav class="nhsuk-header__navigation mobile-menu" id="header-navigation" role="navigation" aria-label="Primary navigation"
  aria-labelledby="label-navigation">
  <div class="nhsuk-width-container">
    <p class="nhsuk-header__navigation-title"><span id="label-navigation">Menu</span>
      <button class="nhsuk-header__navigation-close" id="close-menu">
        <svg class="nhsuk-icon nhsuk-icon__close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
          aria-hidden="true" focusable="false">
          <path
            d="M13.41 12l5.3-5.29a1 1 0 1 0-1.42-1.42L12 10.59l-5.29-5.3a1 1 0 0 0-1.42 1.42l5.3 5.29-5.3 5.29a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0l5.29-5.3 5.29 5.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42z">
          </path>
        </svg>
        <span class="nhsuk-u-visually-hidden">Close menu</span>
      </button>
    </p>
    <ul class="nhsuk-header__navigation-list">
      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          NHS login
        </h2>
      </li>
      <li class="nhsuk-header__navigation-item nhsuk-header__navigation-item--for-mobile">
        <a class="nhsuk-header__navigation-link" href="/">
          What is NHS login
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/oidc-login-flow">
          The OIDC login flow
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          Tesing NHS login
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/test-login-service">
          Test Environments
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>
      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/integrating-to-sandpit">
          Integrate to the sandpit
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>
      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/generating-pem">
          Generating public key
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          External Interface Specification
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/interface-spec-doc">
          Interface Specification Document
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          Conformance
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/technical-conformance">
          Technical Conformance
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          Developer Support Information
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/developer-support">
          Developer Support
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

       <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          GP Credentials
        </h2>
      </li>

       <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/gp-credentials-para">
          Using NHS login to create or retrieve GP credentials
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/gp-credentials-doc">
          Scope and processing overview
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          Button Guidance
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/adding-buttons">
          Adding the NHS login button to your service
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>

      <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          NHS login user settings
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/linking-to-settings-para">
          Settings information
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>


       <li>
        <h2 class="app-side-nav__heading mobile-menu__heading">
          Examples
        </h2>
      </li>

      <li class="nhsuk-header__navigation-item">
        <a class="nhsuk-header__navigation-link" href="/nhslogin/example-oidc">
          Example OIDC clients
          <svg class="nhsuk-icon nhsuk-icon__chevron-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
            aria-hidden="true">
            <path
              d="M15.5 12a1 1 0 0 1-.29.71l-5 5a1 1 0 0 1-1.42-1.42l4.3-4.29-4.3-4.29a1 1 0 0 1 1.42-1.42l5 5a1 1 0 0 1 .29.71z">
            </path>
          </svg>
        </a>
      </li>
    </ul>
  </div>
</nav>
</header>

<div class="nhsuk-width-container">
  <main class="nhsuk-main-wrapper app-main-wrapper" id="maincontent">

    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-full app-component-reading-width">

        <div class="app-pane">

         <div class="app-pane__side-bar">

            <nav class="app-side-nav">
            
                <h2 class="app-side-nav__heading">NHS login</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="/nhslogin">What is NHS login?</a>
                  </li>
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/oidc-login-flow">The OIDC login flow</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">Integrating with NHS login</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="/nhslogin/integration-process">The NHS login integration process</a>
                  </li>
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/adding-buttons">Adding the NHS login button to your service</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">Testing NHS login</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="/nhslogin/test-login-service">Test environments</a>
                  </li>
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/integrating-to-sandpit">Integrate to the sandpit</a>
                  </li>
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/generating-pem">Generate public key</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">External Interface Specification</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/interface-spec-doc">Interface Specification Document</a>
                </ul>

                <h2 class="app-side-nav__heading">Conformance</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/technical-conformance">Technical Conformance</a>
                  </li>
                </ul>

                <h2 class="app-side-nav__heading">Developer Support Information</h2>
                <ul class="nhsuk-list app-side-nav__list">

                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/developer-support">Developer Support</a>
                  </li>
                </ul>

                <h2 class="app-side-nav__heading">GP Credentials</h2>
                <ul class="nhsuk-list app-side-nav__list">
                   <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/gp-credentials">Using NHS login to create or retrieve GP credentials</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">NHS login user settings</h2>
                <ul class="nhsuk-list app-side-nav__list">
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/linking-to-settings-para">Settings information</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">Single Sign On</h2>
                <ul class="nhsuk-list app-side-nav__list">
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/single-sign-on">SSO guidance</a>
                  </li>
                </ul>
                <h2 class="app-side-nav__heading">Examples</h2>
                <ul class="nhsuk-list app-side-nav__list">
                  <li class="app-side-nav__item">
                    <a class="app-side-nav__link" href="nhslogin/example-oidc">Example OIDC clients</a>
                  </li>
                </ul>
            </nav>
          </div>


          <div class="app-pane__main-content">

            <h1 class="app-page-heading">
              Single Sign On
            </h1>

            <p>NHS login supports Single Sign On (SSO) based on an asserted token exchange between two Relying Parties (RP1 &amp; RP2).</p>
<ul>
<li>Asserted tokens are one time tokens (TTL 60 sec)</li>
<li>Partner services can control which other partner services they share SSO with</li>
</ul>
<p>NHS login supports two parameters <code>asserted_login_identity</code> and <code>prompt</code> as part of the OIDC flow which will allows for seamless login between two Relying Parties (RP1 and RP2).</p>
<hr>
<h2>Technical details</h2>
<p>Please refer to NHS login <a href="https://nhsconnect.github.io/nhslogin/interface-spec-doc/">external interface specification</a> for most up-to-date technical details</p>
<h3>parameter: prompt</h3>
<p>This is an optional parameter.</p>
<p>Requests that the NHS login Service forces the user to sign-in, or to request that the Service does not prompt the user to sign-in (SSO).</p>
<table>
<thead>
<tr>
<th><strong>Value</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;blank&gt;</code></td>
<td>The service will SSO the user if they still have a valid session, <br> else the user will be requested to log in.</td>
</tr>
<tr>
<td><code>&quot;none&quot;</code></td>
<td>The Service will SSO the user if they still have a valid session, <br> otherwise an error code is returned</td>
</tr>
<tr>
<td><code>&quot;login&quot;</code></td>
<td>The Service will request the user to log in, regardless of a session <br> already existing.</td>
</tr>
</tbody>
</table>
<h3>parameter: asserted_login_identity</h3>
<p>This is an optional parameter.</p>
<p>The purpose of this parameter is to support seamless login between two RPs (RP1 and RP2) where cookie-based SSO is not available.</p>
<p>The content will be a signed <code>jwt</code> with payload containing <code>“code”</code> attribute with the value being that of the <code>jti</code> attribute from the ID Token issued to RP1. The <code>jwt “iss”</code> attribute <strong>MUST</strong> contain the client_id of RP1, the <code>jwt</code> <strong>MUST</strong> have an <code>“exp”</code> of no longer that 60 seconds, <strong>MUST</strong> have <code>“jti”</code> and <code>“iat”</code> attributes (as per RFC7519) and <strong>MUST</strong> be signed by RP1 using its client private key. RP1 passes the <code>jwt</code> to RP2 for RP2 to use in its authentication request.</p>
<p>A non-normative example jwt payload section is as follows:</p>
<pre class="language-html"><code class="language-html">{<br>  code: “eeroifoteiwrudjdwusdu”,<br>  iss: “client1”,<br>  jti: “reioteotijdvorijevoihroi”,<br>  iat: 1548701645,<br>  exp: 1548701705<br>}</code></pre>
<hr>
<h2>SSO flow</h2>
<h3>Step 1: login to RP1</h3>
<p>User requests RP1 login - OIDC flow - Authorisation code flow</p>
<p><img src="https://github.com/nhsconnect/nhslogin/raw/files-into-markdown/src/images/Step1_smaller.png" alt="diagram" title="Step 1: login to RP1 diagram"></p>
<h3>Step 2: SSO from RP1 to RP2</h3>
<p>User transitions from RP1 to RP2 - Single Sign On - Asserted token flow</p>
<p><img src="https://github.com/nhsconnect/nhslogin/raw/files-into-markdown/src/images/Step2_smaller.png" alt="diagram" title="Step 2: SSO from RP1 to RP2 diagram"></p>
<h3>SSO sequence diagram</h3>
<p><img src="https://github.com/nhsconnect/nhslogin/raw/files-into-markdown/src/images/SequenceDiagram_smaller.png" alt="diagram" title="SSO sequence diagram"></p>


     <div class="app-edit-instructions">
              <hr />
              <p>Edit <a href="https://github.com/nhsconnect/nhslogin/blob/master/./src/single-sign-on2.md">this page</a> on GitHub
              </p>
      </div>

            <div class="app-index-navigation app-u-hide-desktop">
              <nav class="app-side-nav">
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<footer role="contentinfo">
  <div class="nhsuk-footer" id="nhsuk-footer">
    <div class="nhsuk-width-container">
      <h2 class="nhsuk-u-visually-hidden">Support links</h2>
      <ul class="nhsuk-footer__list">
        <li class="nhsuk-footer__list-item">
          <a class="nhsuk-footer__list-item-link" href="https://github.com/nhsconnect/nhslogin">Github</a>
        </li>
       <li class="nhsuk-footer__list-item">
          <a class "nhsuk-footer__list-item-link" href="https://nhs-login-support-slack-invite.herokuapp.com/">Slack</a>
        </li>
       <li class="nhsuk-footer__list-item">
          <a class "nhsuk-footer__list-item-link" href="mailto:engage.nhslogin@nhs.net">engage.nhslogin@nhs.net</a>
        </li>
      </ul>
      <p class="nhsuk-footer__copyright">© Crown copyright</p>
    </div>
  </div>
  <div class="app-ogl-footer">
    <div class="nhsuk-width-container"></div>
  </div>
</footer>
<script src="nhslogin/js/mobile-menu.js" ></script> 
</body>
</html>
